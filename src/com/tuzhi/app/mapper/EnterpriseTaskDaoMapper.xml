<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper   
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"   
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="EnterpriseTaskDaoMapper">
	<resultMap type="com.tuzhi.app.entity.AppTask" id="resultTask"/>
	
	<!-- 企业发布任务（添加） -->
  	<insert id="insertTask" parameterType="map" >
		insert into app_task(
		  <if test="title != null and title != ''">
			title,
		  </if>
		  <if test="content != null and content != ''">
			content,
		  </if>
		  <if test="order_code != null and order_code != ''">
			order_code,
		  </if>
		  <if test="start_time != null and start_time != ''">
			start_time,
		  </if>
		  <if test="end_time != null and end_time != ''">
			end_time,
		  </if>
		  <if test="money != null and money != ''">
			money,
		  </if>
		  <if test="is_urgent != null and is_urgent != ''">
			is_urgent,
		  </if>
		  <if test="is_acceptace != null and is_acceptace != ''">
			is_acceptace,
		  </if>
		  <if test="create_user_id != null and create_user_id != ''">
			create_user_id,
		  </if>
		  <if test="create_per != null and create_per != ''">
			create_per,
		  </if>
		  <if test="status != null and status != ''">
			status,
		  </if>
		  <if test="field_id != null and field_id != ''">
			field_id,
		  </if>
		  <if test="address_id != null and address_id != ''">
			address_id,
		  </if>
		  <if test="desc != null and desc != ''">
			desc,
		  </if>
		    create_time
		)values(
		  <if test="title != null and title != ''">
			#{title},
		  </if>
		  <if test="content != null and content != ''">
			#{content},
		  </if>
		  <if test="order_code != null and order_code != ''">
			#{order_code},
		  </if>
		  <if test="start_time != null and start_time != ''">
			#{start_time},
		  </if>
		  <if test="end_time != null and end_time != ''">
			#{end_time},
		  </if>
		  <if test="money != null and money != ''">
			#{money},
		  </if>
		  <if test="is_urgent != null and is_urgent != ''">
			#{is_urgent},
		  </if>
		  <if test="is_acceptace != null and is_acceptace != ''">
			#{is_acceptace},
		  </if>
		  <if test="create_user_id != null and create_user_id != ''">
			#{create_user_id},
		  </if>
		  <if test="create_per != null and create_per != ''">
			#{create_per},
		  </if>
		  <if test="status != null and status != ''">
			#{status},
		  </if>
		  <if test="field_id != null and field_id != ''">
			#{field_id},
		  </if>
		  <if test="address_id != null and address_id != ''">
			#{address_id},
		  </if>
		  <if test="desc != null and desc != ''">
			#{desc},
		  </if>
		    getdate()
		)
  	</insert>
	
	<!-- 查询任务列表  -->
	<select id=getTask parameterType="map" resultMap="resultTask">
		select t.* from app_task t 
 			left join app_task_user u on t.id=u.order_id
 			where 1=1 
  		 <if test="user_id !=null and user_id != ''">
			and u.user_id=#{user_id}
		 </if>
		order by t.create_time desc
	</select>
	
</mapper>